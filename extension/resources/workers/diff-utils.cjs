"use strict";var Xe=Object.create;var ee=Object.defineProperty;var $e=Object.getOwnPropertyDescriptor;var Ge=Object.getOwnPropertyNames;var Ze=Object.getPrototypeOf,Ke=Object.prototype.hasOwnProperty;var W=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var ce=(e,r,n,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of Ge(r))!Ke.call(e,i)&&i!==n&&ee(e,i,{get:()=>r[i],enumerable:!(t=$e(r,i))||t.enumerable});return e};var ge=(e,r,n)=>(n=e!=null?Xe(Ze(e)):{},ce(r||!e||!e.__esModule?ee(n,"default",{value:e,enumerable:!0}):n,e)),Ye=e=>ce(ee({},"__esModule",{value:!0}),e);var me=W((_r,U)=>{var h=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},k=-1,_=1,p=0;h.Diff=function(e,r){return[e,r]};h.prototype.diff_main=function(e,r,n,t){typeof t>"u"&&(this.Diff_Timeout<=0?t=Number.MAX_VALUE:t=new Date().getTime()+this.Diff_Timeout*1e3);var i=t;if(e==null||r==null)throw new Error("Null input. (diff_main)");if(e==r)return e?[new h.Diff(p,e)]:[];typeof n>"u"&&(n=!0);var s=n,o=this.diff_commonPrefix(e,r),a=e.substring(0,o);e=e.substring(o),r=r.substring(o),o=this.diff_commonSuffix(e,r);var u=e.substring(e.length-o);e=e.substring(0,e.length-o),r=r.substring(0,r.length-o);var f=this.diff_compute_(e,r,s,i);return a&&f.unshift(new h.Diff(p,a)),u&&f.push(new h.Diff(p,u)),this.diff_cleanupMerge(f),f};h.prototype.diff_compute_=function(e,r,n,t){var i;if(!e)return[new h.Diff(_,r)];if(!r)return[new h.Diff(k,e)];var s=e.length>r.length?e:r,o=e.length>r.length?r:e,a=s.indexOf(o);if(a!=-1)return i=[new h.Diff(_,s.substring(0,a)),new h.Diff(p,o),new h.Diff(_,s.substring(a+o.length))],e.length>r.length&&(i[0][0]=i[2][0]=k),i;if(o.length==1)return[new h.Diff(k,e),new h.Diff(_,r)];var u=this.diff_halfMatch_(e,r);if(u){var f=u[0],l=u[1],c=u[2],m=u[3],g=u[4],v=this.diff_main(f,c,n,t),b=this.diff_main(l,m,n,t);return v.concat([new h.Diff(p,g)],b)}return n&&e.length>100&&r.length>100?this.diff_lineMode_(e,r,t):this.diff_bisect_(e,r,t)};h.prototype.diff_lineMode_=function(e,r,n){var t=this.diff_linesToChars_(e,r);e=t.chars1,r=t.chars2;var i=t.lineArray,s=this.diff_main(e,r,!1,n);this.diff_charsToLines_(s,i),this.diff_cleanupSemantic(s),s.push(new h.Diff(p,""));for(var o=0,a=0,u=0,f="",l="";o<s.length;){switch(s[o][0]){case _:u++,l+=s[o][1];break;case k:a++,f+=s[o][1];break;case p:if(a>=1&&u>=1){s.splice(o-a-u,a+u),o=o-a-u;for(var c=this.diff_main(f,l,!1,n),m=c.length-1;m>=0;m--)s.splice(o,0,c[m]);o=o+c.length}u=0,a=0,f="",l="";break}o++}return s.pop(),s};h.prototype.diff_bisect_=function(e,r,n){for(var t=e.length,i=r.length,s=Math.ceil((t+i)/2),o=s,a=2*s,u=new Array(a),f=new Array(a),l=0;l<a;l++)u[l]=-1,f[l]=-1;u[o+1]=0,f[o+1]=0;for(var c=t-i,m=c%2!=0,g=0,v=0,b=0,T=0,w=0;w<s&&!(new Date().getTime()>n);w++){for(var y=-w+g;y<=w-v;y+=2){var E=o+y,O;y==-w||y!=w&&u[E-1]<u[E+1]?O=u[E+1]:O=u[E-1]+1;for(var D=O-y;O<t&&D<i&&e.charAt(O)==r.charAt(D);)O++,D++;if(u[E]=O,O>t)v+=2;else if(D>i)g+=2;else if(m){var L=o+c-y;if(L>=0&&L<a&&f[L]!=-1){var M=t-f[L];if(O>=M)return this.diff_bisectSplit_(e,r,O,D,n)}}}for(var A=-w+b;A<=w-T;A+=2){var L=o+A,M;A==-w||A!=w&&f[L-1]<f[L+1]?M=f[L+1]:M=f[L-1]+1;for(var j=M-A;M<t&&j<i&&e.charAt(t-M-1)==r.charAt(i-j-1);)M++,j++;if(f[L]=M,M>t)T+=2;else if(j>i)b+=2;else if(!m){var E=o+c-A;if(E>=0&&E<a&&u[E]!=-1){var O=u[E],D=o+O-E;if(M=t-M,O>=M)return this.diff_bisectSplit_(e,r,O,D,n)}}}}return[new h.Diff(k,e),new h.Diff(_,r)]};h.prototype.diff_bisectSplit_=function(e,r,n,t,i){var s=e.substring(0,n),o=r.substring(0,t),a=e.substring(n),u=r.substring(t),f=this.diff_main(s,o,!1,i),l=this.diff_main(a,u,!1,i);return f.concat(l)};h.prototype.diff_linesToChars_=function(e,r){var n=[],t={};n[0]="";function i(u){for(var f="",l=0,c=-1,m=n.length;c<u.length-1;){c=u.indexOf(`
`,l),c==-1&&(c=u.length-1);var g=u.substring(l,c+1);(t.hasOwnProperty?t.hasOwnProperty(g):t[g]!==void 0)?f+=String.fromCharCode(t[g]):(m==s&&(g=u.substring(l),c=u.length),f+=String.fromCharCode(m),t[g]=m,n[m++]=g),l=c+1}return f}var s=4e4,o=i(e);s=65535;var a=i(r);return{chars1:o,chars2:a,lineArray:n}};h.prototype.diff_charsToLines_=function(e,r){for(var n=0;n<e.length;n++){for(var t=e[n][1],i=[],s=0;s<t.length;s++)i[s]=r[t.charCodeAt(s)];e[n][1]=i.join("")}};h.prototype.diff_commonPrefix=function(e,r){if(!e||!r||e.charAt(0)!=r.charAt(0))return 0;for(var n=0,t=Math.min(e.length,r.length),i=t,s=0;n<i;)e.substring(s,i)==r.substring(s,i)?(n=i,s=n):t=i,i=Math.floor((t-n)/2+n);return i};h.prototype.diff_commonSuffix=function(e,r){if(!e||!r||e.charAt(e.length-1)!=r.charAt(r.length-1))return 0;for(var n=0,t=Math.min(e.length,r.length),i=t,s=0;n<i;)e.substring(e.length-i,e.length-s)==r.substring(r.length-i,r.length-s)?(n=i,s=n):t=i,i=Math.floor((t-n)/2+n);return i};h.prototype.diff_commonOverlap_=function(e,r){var n=e.length,t=r.length;if(n==0||t==0)return 0;n>t?e=e.substring(n-t):n<t&&(r=r.substring(0,n));var i=Math.min(n,t);if(e==r)return i;for(var s=0,o=1;;){var a=e.substring(i-o),u=r.indexOf(a);if(u==-1)return s;o+=u,(u==0||e.substring(i-o)==r.substring(0,o))&&(s=o,o++)}};h.prototype.diff_halfMatch_=function(e,r){if(this.Diff_Timeout<=0)return null;var n=e.length>r.length?e:r,t=e.length>r.length?r:e;if(n.length<4||t.length*2<n.length)return null;var i=this;function s(v,b,T){for(var w=v.substring(T,T+Math.floor(v.length/4)),y=-1,E="",O,D,L,M;(y=b.indexOf(w,y+1))!=-1;){var A=i.diff_commonPrefix(v.substring(T),b.substring(y)),j=i.diff_commonSuffix(v.substring(0,T),b.substring(0,y));E.length<j+A&&(E=b.substring(y-j,y)+b.substring(y,y+A),O=v.substring(0,T-j),D=v.substring(T+A),L=b.substring(0,y-j),M=b.substring(y+A))}return E.length*2>=v.length?[O,D,L,M,E]:null}var o=s(n,t,Math.ceil(n.length/4)),a=s(n,t,Math.ceil(n.length/2)),u;if(!o&&!a)return null;a?o?u=o[4].length>a[4].length?o:a:u=a:u=o;var f,l,c,m;e.length>r.length?(f=u[0],l=u[1],c=u[2],m=u[3]):(c=u[0],m=u[1],f=u[2],l=u[3]);var g=u[4];return[f,l,c,m,g]};h.prototype.diff_cleanupSemantic=function(e){for(var r=!1,n=[],t=0,i=null,s=0,o=0,a=0,u=0,f=0;s<e.length;)e[s][0]==p?(n[t++]=s,o=u,a=f,u=0,f=0,i=e[s][1]):(e[s][0]==_?u+=e[s][1].length:f+=e[s][1].length,i&&i.length<=Math.max(o,a)&&i.length<=Math.max(u,f)&&(e.splice(n[t-1],0,new h.Diff(k,i)),e[n[t-1]+1][0]=_,t--,t--,s=t>0?n[t-1]:-1,o=0,a=0,u=0,f=0,i=null,r=!0)),s++;for(r&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),s=1;s<e.length;){if(e[s-1][0]==k&&e[s][0]==_){var l=e[s-1][1],c=e[s][1],m=this.diff_commonOverlap_(l,c),g=this.diff_commonOverlap_(c,l);m>=g?(m>=l.length/2||m>=c.length/2)&&(e.splice(s,0,new h.Diff(p,c.substring(0,m))),e[s-1][1]=l.substring(0,l.length-m),e[s+1][1]=c.substring(m),s++):(g>=l.length/2||g>=c.length/2)&&(e.splice(s,0,new h.Diff(p,l.substring(0,g))),e[s-1][0]=_,e[s-1][1]=c.substring(0,c.length-g),e[s+1][0]=k,e[s+1][1]=l.substring(g),s++),s++}s++}};h.prototype.diff_cleanupSemanticLossless=function(e){function r(g,v){if(!g||!v)return 6;var b=g.charAt(g.length-1),T=v.charAt(0),w=b.match(h.nonAlphaNumericRegex_),y=T.match(h.nonAlphaNumericRegex_),E=w&&b.match(h.whitespaceRegex_),O=y&&T.match(h.whitespaceRegex_),D=E&&b.match(h.linebreakRegex_),L=O&&T.match(h.linebreakRegex_),M=D&&g.match(h.blanklineEndRegex_),A=L&&v.match(h.blanklineStartRegex_);return M||A?5:D||L?4:w&&!E&&O?3:E||O?2:w||y?1:0}for(var n=1;n<e.length-1;){if(e[n-1][0]==p&&e[n+1][0]==p){var t=e[n-1][1],i=e[n][1],s=e[n+1][1],o=this.diff_commonSuffix(t,i);if(o){var a=i.substring(i.length-o);t=t.substring(0,t.length-o),i=a+i.substring(0,i.length-o),s=a+s}for(var u=t,f=i,l=s,c=r(t,i)+r(i,s);i.charAt(0)===s.charAt(0);){t+=i.charAt(0),i=i.substring(1)+s.charAt(0),s=s.substring(1);var m=r(t,i)+r(i,s);m>=c&&(c=m,u=t,f=i,l=s)}e[n-1][1]!=u&&(u?e[n-1][1]=u:(e.splice(n-1,1),n--),e[n][1]=f,l?e[n+1][1]=l:(e.splice(n+1,1),n--))}n++}};h.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/;h.whitespaceRegex_=/\s/;h.linebreakRegex_=/[\r\n]/;h.blanklineEndRegex_=/\n\r?\n$/;h.blanklineStartRegex_=/^\r?\n\r?\n/;h.prototype.diff_cleanupEfficiency=function(e){for(var r=!1,n=[],t=0,i=null,s=0,o=!1,a=!1,u=!1,f=!1;s<e.length;)e[s][0]==p?(e[s][1].length<this.Diff_EditCost&&(u||f)?(n[t++]=s,o=u,a=f,i=e[s][1]):(t=0,i=null),u=f=!1):(e[s][0]==k?f=!0:u=!0,i&&(o&&a&&u&&f||i.length<this.Diff_EditCost/2&&o+a+u+f==3)&&(e.splice(n[t-1],0,new h.Diff(k,i)),e[n[t-1]+1][0]=_,t--,i=null,o&&a?(u=f=!0,t=0):(t--,s=t>0?n[t-1]:-1,u=f=!1),r=!0)),s++;r&&this.diff_cleanupMerge(e)};h.prototype.diff_cleanupMerge=function(e){e.push(new h.Diff(p,""));for(var r=0,n=0,t=0,i="",s="",o;r<e.length;)switch(e[r][0]){case _:t++,s+=e[r][1],r++;break;case k:n++,i+=e[r][1],r++;break;case p:n+t>1?(n!==0&&t!==0&&(o=this.diff_commonPrefix(s,i),o!==0&&(r-n-t>0&&e[r-n-t-1][0]==p?e[r-n-t-1][1]+=s.substring(0,o):(e.splice(0,0,new h.Diff(p,s.substring(0,o))),r++),s=s.substring(o),i=i.substring(o)),o=this.diff_commonSuffix(s,i),o!==0&&(e[r][1]=s.substring(s.length-o)+e[r][1],s=s.substring(0,s.length-o),i=i.substring(0,i.length-o))),r-=n+t,e.splice(r,n+t),i.length&&(e.splice(r,0,new h.Diff(k,i)),r++),s.length&&(e.splice(r,0,new h.Diff(_,s)),r++),r++):r!==0&&e[r-1][0]==p?(e[r-1][1]+=e[r][1],e.splice(r,1)):r++,t=0,n=0,i="",s="";break}e[e.length-1][1]===""&&e.pop();var a=!1;for(r=1;r<e.length-1;)e[r-1][0]==p&&e[r+1][0]==p&&(e[r][1].substring(e[r][1].length-e[r-1][1].length)==e[r-1][1]?(e[r][1]=e[r-1][1]+e[r][1].substring(0,e[r][1].length-e[r-1][1].length),e[r+1][1]=e[r-1][1]+e[r+1][1],e.splice(r-1,1),a=!0):e[r][1].substring(0,e[r+1][1].length)==e[r+1][1]&&(e[r-1][1]+=e[r+1][1],e[r][1]=e[r][1].substring(e[r+1][1].length)+e[r+1][1],e.splice(r+1,1),a=!0)),r++;a&&this.diff_cleanupMerge(e)};h.prototype.diff_xIndex=function(e,r){var n=0,t=0,i=0,s=0,o;for(o=0;o<e.length&&(e[o][0]!==_&&(n+=e[o][1].length),e[o][0]!==k&&(t+=e[o][1].length),!(n>r));o++)i=n,s=t;return e.length!=o&&e[o][0]===k?s:s+(r-i)};h.prototype.diff_prettyHtml=function(e){for(var r=[],n=/&/g,t=/</g,i=/>/g,s=/\n/g,o=0;o<e.length;o++){var a=e[o][0],u=e[o][1],f=u.replace(n,"&amp;").replace(t,"&lt;").replace(i,"&gt;").replace(s,"&para;<br>");switch(a){case _:r[o]='<ins style="background:#e6ffe6;">'+f+"</ins>";break;case k:r[o]='<del style="background:#ffe6e6;">'+f+"</del>";break;case p:r[o]="<span>"+f+"</span>";break}}return r.join("")};h.prototype.diff_text1=function(e){for(var r=[],n=0;n<e.length;n++)e[n][0]!==_&&(r[n]=e[n][1]);return r.join("")};h.prototype.diff_text2=function(e){for(var r=[],n=0;n<e.length;n++)e[n][0]!==k&&(r[n]=e[n][1]);return r.join("")};h.prototype.diff_levenshtein=function(e){for(var r=0,n=0,t=0,i=0;i<e.length;i++){var s=e[i][0],o=e[i][1];switch(s){case _:n+=o.length;break;case k:t+=o.length;break;case p:r+=Math.max(n,t),n=0,t=0;break}}return r+=Math.max(n,t),r};h.prototype.diff_toDelta=function(e){for(var r=[],n=0;n<e.length;n++)switch(e[n][0]){case _:r[n]="+"+encodeURI(e[n][1]);break;case k:r[n]="-"+e[n][1].length;break;case p:r[n]="="+e[n][1].length;break}return r.join("	").replace(/%20/g," ")};h.prototype.diff_fromDelta=function(e,r){for(var n=[],t=0,i=0,s=r.split(/\t/g),o=0;o<s.length;o++){var a=s[o].substring(1);switch(s[o].charAt(0)){case"+":try{n[t++]=new h.Diff(_,decodeURI(a))}catch{throw new Error("Illegal escape in diff_fromDelta: "+a)}break;case"-":case"=":var u=parseInt(a,10);if(isNaN(u)||u<0)throw new Error("Invalid number in diff_fromDelta: "+a);var f=e.substring(i,i+=u);s[o].charAt(0)=="="?n[t++]=new h.Diff(p,f):n[t++]=new h.Diff(k,f);break;default:if(s[o])throw new Error("Invalid diff operation in diff_fromDelta: "+s[o])}}if(i!=e.length)throw new Error("Delta length ("+i+") does not equal source text length ("+e.length+").");return n};h.prototype.match_main=function(e,r,n){if(e==null||r==null||n==null)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==r?0:e.length?e.substring(n,n+r.length)==r?n:this.match_bitap_(e,r,n):-1};h.prototype.match_bitap_=function(e,r,n){if(r.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var t=this.match_alphabet_(r),i=this;function s(O,D){var L=O/r.length,M=Math.abs(n-D);return i.Match_Distance?L+M/i.Match_Distance:M?1:L}var o=this.Match_Threshold,a=e.indexOf(r,n);a!=-1&&(o=Math.min(s(0,a),o),a=e.lastIndexOf(r,n+r.length),a!=-1&&(o=Math.min(s(0,a),o)));var u=1<<r.length-1;a=-1;for(var f,l,c=r.length+e.length,m,g=0;g<r.length;g++){for(f=0,l=c;f<l;)s(g,n+l)<=o?f=l:c=l,l=Math.floor((c-f)/2+f);c=l;var v=Math.max(1,n-l+1),b=Math.min(n+l,e.length)+r.length,T=Array(b+2);T[b+1]=(1<<g)-1;for(var w=b;w>=v;w--){var y=t[e.charAt(w-1)];if(g===0?T[w]=(T[w+1]<<1|1)&y:T[w]=(T[w+1]<<1|1)&y|((m[w+1]|m[w])<<1|1)|m[w+1],T[w]&u){var E=s(g,w-1);if(E<=o)if(o=E,a=w-1,a>n)v=Math.max(1,2*n-a);else break}}if(s(g+1,n)>o)break;m=T}return a};h.prototype.match_alphabet_=function(e){for(var r={},n=0;n<e.length;n++)r[e.charAt(n)]=0;for(var n=0;n<e.length;n++)r[e.charAt(n)]|=1<<e.length-n-1;return r};h.prototype.patch_addContext_=function(e,r){if(r.length!=0){if(e.start2===null)throw Error("patch not initialized");for(var n=r.substring(e.start2,e.start2+e.length1),t=0;r.indexOf(n)!=r.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)t+=this.Patch_Margin,n=r.substring(e.start2-t,e.start2+e.length1+t);t+=this.Patch_Margin;var i=r.substring(e.start2-t,e.start2);i&&e.diffs.unshift(new h.Diff(p,i));var s=r.substring(e.start2+e.length1,e.start2+e.length1+t);s&&e.diffs.push(new h.Diff(p,s)),e.start1-=i.length,e.start2-=i.length,e.length1+=i.length+s.length,e.length2+=i.length+s.length}};h.prototype.patch_make=function(e,r,n){var t,i;if(typeof e=="string"&&typeof r=="string"&&typeof n>"u")t=e,i=this.diff_main(t,r,!0),i.length>2&&(this.diff_cleanupSemantic(i),this.diff_cleanupEfficiency(i));else if(e&&typeof e=="object"&&typeof r>"u"&&typeof n>"u")i=e,t=this.diff_text1(i);else if(typeof e=="string"&&r&&typeof r=="object"&&typeof n>"u")t=e,i=r;else if(typeof e=="string"&&typeof r=="string"&&n&&typeof n=="object")t=e,i=n;else throw new Error("Unknown call format to patch_make.");if(i.length===0)return[];for(var s=[],o=new h.patch_obj,a=0,u=0,f=0,l=t,c=t,m=0;m<i.length;m++){var g=i[m][0],v=i[m][1];switch(!a&&g!==p&&(o.start1=u,o.start2=f),g){case _:o.diffs[a++]=i[m],o.length2+=v.length,c=c.substring(0,f)+v+c.substring(f);break;case k:o.length1+=v.length,o.diffs[a++]=i[m],c=c.substring(0,f)+c.substring(f+v.length);break;case p:v.length<=2*this.Patch_Margin&&a&&i.length!=m+1?(o.diffs[a++]=i[m],o.length1+=v.length,o.length2+=v.length):v.length>=2*this.Patch_Margin&&a&&(this.patch_addContext_(o,l),s.push(o),o=new h.patch_obj,a=0,l=c,u=f);break}g!==_&&(u+=v.length),g!==k&&(f+=v.length)}return a&&(this.patch_addContext_(o,l),s.push(o)),s};h.prototype.patch_deepCopy=function(e){for(var r=[],n=0;n<e.length;n++){var t=e[n],i=new h.patch_obj;i.diffs=[];for(var s=0;s<t.diffs.length;s++)i.diffs[s]=new h.Diff(t.diffs[s][0],t.diffs[s][1]);i.start1=t.start1,i.start2=t.start2,i.length1=t.length1,i.length2=t.length2,r[n]=i}return r};h.prototype.patch_apply=function(e,r){if(e.length==0)return[r,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);r=n+r+n,this.patch_splitMax(e);for(var t=0,i=[],s=0;s<e.length;s++){var o=e[s].start2+t,a=this.diff_text1(e[s].diffs),u,f=-1;if(a.length>this.Match_MaxBits?(u=this.match_main(r,a.substring(0,this.Match_MaxBits),o),u!=-1&&(f=this.match_main(r,a.substring(a.length-this.Match_MaxBits),o+a.length-this.Match_MaxBits),(f==-1||u>=f)&&(u=-1))):u=this.match_main(r,a,o),u==-1)i[s]=!1,t-=e[s].length2-e[s].length1;else{i[s]=!0,t=u-o;var l;if(f==-1?l=r.substring(u,u+a.length):l=r.substring(u,f+this.Match_MaxBits),a==l)r=r.substring(0,u)+this.diff_text2(e[s].diffs)+r.substring(u+a.length);else{var c=this.diff_main(a,l,!1);if(a.length>this.Match_MaxBits&&this.diff_levenshtein(c)/a.length>this.Patch_DeleteThreshold)i[s]=!1;else{this.diff_cleanupSemanticLossless(c);for(var m=0,g,v=0;v<e[s].diffs.length;v++){var b=e[s].diffs[v];b[0]!==p&&(g=this.diff_xIndex(c,m)),b[0]===_?r=r.substring(0,u+g)+b[1]+r.substring(u+g):b[0]===k&&(r=r.substring(0,u+g)+r.substring(u+this.diff_xIndex(c,m+b[1].length))),b[0]!==k&&(m+=b[1].length)}}}}}return r=r.substring(n.length,r.length-n.length),[r,i]};h.prototype.patch_addPadding=function(e){for(var r=this.Patch_Margin,n="",t=1;t<=r;t++)n+=String.fromCharCode(t);for(var t=0;t<e.length;t++)e[t].start1+=r,e[t].start2+=r;var i=e[0],s=i.diffs;if(s.length==0||s[0][0]!=p)s.unshift(new h.Diff(p,n)),i.start1-=r,i.start2-=r,i.length1+=r,i.length2+=r;else if(r>s[0][1].length){var o=r-s[0][1].length;s[0][1]=n.substring(s[0][1].length)+s[0][1],i.start1-=o,i.start2-=o,i.length1+=o,i.length2+=o}if(i=e[e.length-1],s=i.diffs,s.length==0||s[s.length-1][0]!=p)s.push(new h.Diff(p,n)),i.length1+=r,i.length2+=r;else if(r>s[s.length-1][1].length){var o=r-s[s.length-1][1].length;s[s.length-1][1]+=n.substring(0,o),i.length1+=o,i.length2+=o}return n};h.prototype.patch_splitMax=function(e){for(var r=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=r)){var t=e[n];e.splice(n--,1);for(var i=t.start1,s=t.start2,o="";t.diffs.length!==0;){var a=new h.patch_obj,u=!0;for(a.start1=i-o.length,a.start2=s-o.length,o!==""&&(a.length1=a.length2=o.length,a.diffs.push(new h.Diff(p,o)));t.diffs.length!==0&&a.length1<r-this.Patch_Margin;){var f=t.diffs[0][0],l=t.diffs[0][1];f===_?(a.length2+=l.length,s+=l.length,a.diffs.push(t.diffs.shift()),u=!1):f===k&&a.diffs.length==1&&a.diffs[0][0]==p&&l.length>2*r?(a.length1+=l.length,i+=l.length,u=!1,a.diffs.push(new h.Diff(f,l)),t.diffs.shift()):(l=l.substring(0,r-a.length1-this.Patch_Margin),a.length1+=l.length,i+=l.length,f===p?(a.length2+=l.length,s+=l.length):u=!1,a.diffs.push(new h.Diff(f,l)),l==t.diffs[0][1]?t.diffs.shift():t.diffs[0][1]=t.diffs[0][1].substring(l.length))}o=this.diff_text2(a.diffs),o=o.substring(o.length-this.Patch_Margin);var c=this.diff_text1(t.diffs).substring(0,this.Patch_Margin);c!==""&&(a.length1+=c.length,a.length2+=c.length,a.diffs.length!==0&&a.diffs[a.diffs.length-1][0]===p?a.diffs[a.diffs.length-1][1]+=c:a.diffs.push(new h.Diff(p,c))),u||e.splice(++n,0,a)}}};h.prototype.patch_toText=function(e){for(var r=[],n=0;n<e.length;n++)r[n]=e[n];return r.join("")};h.prototype.patch_fromText=function(e){var r=[];if(!e)return r;for(var n=e.split(`
`),t=0,i=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;t<n.length;){var s=n[t].match(i);if(!s)throw new Error("Invalid patch string: "+n[t]);var o=new h.patch_obj;for(r.push(o),o.start1=parseInt(s[1],10),s[2]===""?(o.start1--,o.length1=1):s[2]=="0"?o.length1=0:(o.start1--,o.length1=parseInt(s[2],10)),o.start2=parseInt(s[3],10),s[4]===""?(o.start2--,o.length2=1):s[4]=="0"?o.length2=0:(o.start2--,o.length2=parseInt(s[4],10)),t++;t<n.length;){var a=n[t].charAt(0);try{var u=decodeURI(n[t].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+u)}if(a=="-")o.diffs.push(new h.Diff(k,u));else if(a=="+")o.diffs.push(new h.Diff(_,u));else if(a==" ")o.diffs.push(new h.Diff(p,u));else{if(a=="@")break;if(a!=="")throw new Error('Invalid patch mode "'+a+'" in: '+u)}t++}}return r};h.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0};h.patch_obj.prototype.toString=function(){var e,r;this.length1===0?e=this.start1+",0":this.length1==1?e=this.start1+1:e=this.start1+1+","+this.length1,this.length2===0?r=this.start2+",0":this.length2==1?r=this.start2+1:r=this.start2+1+","+this.length2;for(var n=["@@ -"+e+" +"+r+` @@
`],t,i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case _:t="+";break;case k:t="-";break;case p:t=" ";break}n[i+1]=t+encodeURI(this.diffs[i][1])+`
`}return n.join("").replace(/%20/g," ")};U.exports=h;U.exports.diff_match_patch=h;U.exports.DIFF_DELETE=k;U.exports.DIFF_INSERT=_;U.exports.DIFF_EQUAL=p});var Z=W((Er,N)=>{var pe=function(e){return typeof e<"u"&&e.versions!=null&&e.versions.node!=null&&e+""=="[object process]"};N.exports.isNode=pe;N.exports.platform=typeof process<"u"&&pe(process)?"node":"browser";var de=N.exports.platform==="node"&&require("worker_threads");N.exports.isMainThread=N.exports.platform==="node"?(!de||de.isMainThread)&&!process.connected:typeof Window<"u";N.exports.cpus=N.exports.platform==="browser"?self.navigator.hardwareConcurrency:require("os").cpus().length});var J=W(we=>{"use strict";function S(e,r){var n=this;if(!(this instanceof S))throw new SyntaxError("Constructor must be called with the new operator");if(typeof e!="function")throw new SyntaxError("Function parameter handler(resolve, reject) missing");var t=[],i=[];this.resolved=!1,this.rejected=!1,this.pending=!0,this[Symbol.toStringTag]="Promise";var s=function(u,f){t.push(u),i.push(f)};this.then=function(u,f){return new S(function(l,c){var m=u?ve(u,l,c):l,g=f?ve(f,l,c):c;s(m,g)},n)};var o=function(u){return n.resolved=!0,n.rejected=!1,n.pending=!1,t.forEach(function(f){f(u)}),s=function(f,l){f(u)},o=a=function(){},n},a=function(u){return n.resolved=!1,n.rejected=!0,n.pending=!1,i.forEach(function(f){f(u)}),s=function(f,l){l(u)},o=a=function(){},n};this.cancel=function(){return r?r.cancel():a(new z),n},this.timeout=function(u){if(r)r.timeout(u);else{var f=setTimeout(function(){a(new Q("Promise timed out after "+u+" ms"))},u);n.always(function(){clearTimeout(f)})}return n},e(function(u){o(u)},function(u){a(u)})}function ve(e,r,n){return function(t){try{var i=e(t);i&&typeof i.then=="function"&&typeof i.catch=="function"?i.then(r,n):r(i)}catch(s){n(s)}}}S.prototype.catch=function(e){return this.then(null,e)};S.prototype.always=function(e){return this.then(e,e)};S.prototype.finally=function(e){let r=this,n=function(){return new S(t=>t()).then(e).then(()=>r)};return this.then(n,n)};S.all=function(e){return new S(function(r,n){var t=e.length,i=[];t?e.forEach(function(s,o){s.then(function(a){i[o]=a,t--,t==0&&r(i)},function(a){t=0,n(a)})}):r(i)})};S.defer=function(){var e={};return e.promise=new S(function(r,n){e.resolve=r,e.reject=n}),e};function z(e){this.message=e||"promise cancelled",this.stack=new Error().stack}z.prototype=new Error;z.prototype.constructor=Error;z.prototype.name="CancellationError";S.CancellationError=z;function Q(e){this.message=e||"timeout exceeded",this.stack=new Error().stack}Q.prototype=new Error;Q.prototype.constructor=Error;Q.prototype.name="TimeoutError";S.TimeoutError=Q;we.Promise=S});var be=W(q=>{q.validateOptions=function(r,n,t){if(r){var i=r?Object.keys(r):[],s=i.find(a=>!n.includes(a));if(s)throw new Error('Object "'+t+'" contains an unknown option "'+s+'"');var o=n.find(a=>Object.prototype[a]&&!i.includes(a));if(o)throw new Error('Object "'+t+'" contains an inherited option "'+o+'" which is not defined in the object itself but in its prototype. Only plain objects are allowed. Please remove the option from the prototype or override it with a value "undefined".');return r}};q.workerOptsNames=["credentials","name","type"];q.forkOptsNames=["cwd","detached","env","execPath","execArgv","gid","serialization","signal","killSignal","silent","stdio","uid","windowsVerbatimArguments","timeout"];q.workerThreadOptsNames=["argv","env","eval","execArgv","stdin","stdout","stderr","workerData","trackUnmanagedFds","transferList","resourceLimits","name"]});var _e=W((Mr,ke)=>{ke.exports=`!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).worker=n()}(this,(function(){"use strict";function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t={};var r=function(e,n){this.message=e,this.transfer=n},o={};function i(e,n){var t=this;if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if("function"!=typeof e)throw new SyntaxError("Function parameter handler(resolve, reject) missing");var r=[],o=[];this.resolved=!1,this.rejected=!1,this.pending=!0,this[Symbol.toStringTag]="Promise";var a=function(e,n){r.push(e),o.push(n)};this.then=function(e,n){return new i((function(t,r){var o=e?s(e,t,r):t,i=n?s(n,t,r):r;a(o,i)}),t)};var f=function(e){return t.resolved=!0,t.rejected=!1,t.pending=!1,r.forEach((function(n){n(e)})),a=function(n,t){n(e)},f=d=function(){},t},d=function(e){return t.resolved=!1,t.rejected=!0,t.pending=!1,o.forEach((function(n){n(e)})),a=function(n,t){t(e)},f=d=function(){},t};this.cancel=function(){return n?n.cancel():d(new u),t},this.timeout=function(e){if(n)n.timeout(e);else{var r=setTimeout((function(){d(new c("Promise timed out after "+e+" ms"))}),e);t.always((function(){clearTimeout(r)}))}return t},e((function(e){f(e)}),(function(e){d(e)}))}function s(e,n,t){return function(r){try{var o=e(r);o&&"function"==typeof o.then&&"function"==typeof o.catch?o.then(n,t):n(o)}catch(e){t(e)}}}function u(e){this.message=e||"promise cancelled",this.stack=(new Error).stack}function c(e){this.message=e||"timeout exceeded",this.stack=(new Error).stack}return i.prototype.catch=function(e){return this.then(null,e)},i.prototype.always=function(e){return this.then(e,e)},i.prototype.finally=function(e){var n=this,t=function(){return new i((function(e){return e()})).then(e).then((function(){return n}))};return this.then(t,t)},i.all=function(e){return new i((function(n,t){var r=e.length,o=[];r?e.forEach((function(e,i){e.then((function(e){o[i]=e,0==--r&&n(o)}),(function(e){r=0,t(e)}))})):n(o)}))},i.defer=function(){var e={};return e.promise=new i((function(n,t){e.resolve=n,e.reject=t})),e},u.prototype=new Error,u.prototype.constructor=Error,u.prototype.name="CancellationError",i.CancellationError=u,c.prototype=new Error,c.prototype.constructor=Error,c.prototype.name="TimeoutError",i.TimeoutError=c,o.Promise=i,function(n){var t=r,i=o.Promise,s="__workerpool-cleanup__",u={exit:function(){}},c={addAbortListener:function(e){u.abortListeners.push(e)},emit:u.emit};if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)u.on=function(e,n){addEventListener(e,(function(e){n(e.data)}))},u.send=function(e,n){n?postMessage(e,n):postMessage(e)};else{if("undefined"==typeof process)throw new Error("Script must be executed as a worker");var a;try{a=require("worker_threads")}catch(n){if("object"!==e(n)||null===n||"MODULE_NOT_FOUND"!==n.code)throw n}if(a&&null!==a.parentPort){var f=a.parentPort;u.send=f.postMessage.bind(f),u.on=f.on.bind(f),u.exit=process.exit.bind(process)}else u.on=process.on.bind(process),u.send=function(e){process.send(e)},u.on("disconnect",(function(){process.exit(1)})),u.exit=process.exit.bind(process)}function d(e){return e&&e.toJSON?JSON.parse(JSON.stringify(e)):JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)))}function l(e){return e&&"function"==typeof e.then&&"function"==typeof e.catch}u.methods={},u.methods.run=function(e,n){var t=new Function("return ("+e+").apply(this, arguments);");return t.worker=c,t.apply(t,n)},u.methods.methods=function(){return Object.keys(u.methods)},u.terminationHandler=void 0,u.abortListenerTimeout=1e3,u.abortListeners=[],u.terminateAndExit=function(e){var n=function(){u.exit(e)};if(!u.terminationHandler)return n();var t=u.terminationHandler(e);return l(t)?(t.then(n,n),t):(n(),new i((function(e,n){n(new Error("Worker terminating"))})))},u.cleanup=function(e){if(!u.abortListeners.length)return u.send({id:e,method:s,error:d(new Error("Worker terminating"))}),new i((function(e){e()}));var n,t=u.abortListeners.map((function(e){return e()})),r=new i((function(e,t){n=setTimeout((function(){t(new Error("Timeout occured waiting for abort handler, killing worker"))}),u.abortListenerTimeout)})),o=i.all(t).then((function(){clearTimeout(n),u.abortListeners.length||(u.abortListeners=[])}),(function(){clearTimeout(n),u.exit()}));return new i((function(e,n){o.then(e,n),r.then(e,n)})).then((function(){u.send({id:e,method:s,error:null})}),(function(n){u.send({id:e,method:s,error:n?d(n):null})}))};var p=null;u.on("message",(function(e){if("__workerpool-terminate__"===e)return u.terminateAndExit(0);if(e.method===s)return u.cleanup(e.id);try{var n=u.methods[e.method];if(!n)throw new Error('Unknown method "'+e.method+'"');p=e.id;var r=n.apply(n,e.params);l(r)?r.then((function(n){n instanceof t?u.send({id:e.id,result:n.message,error:null},n.transfer):u.send({id:e.id,result:n,error:null}),p=null})).catch((function(n){u.send({id:e.id,result:null,error:d(n)}),p=null})):(r instanceof t?u.send({id:e.id,result:r.message,error:null},r.transfer):u.send({id:e.id,result:r,error:null}),p=null)}catch(n){u.send({id:e.id,result:null,error:d(n)})}})),u.register=function(e,n){if(e)for(var t in e)e.hasOwnProperty(t)&&(u.methods[t]=e[t],u.methods[t].worker=c);n&&(u.terminationHandler=n.onTerminate,u.abortListenerTimeout=n.abortListenerTimeout||1e3),u.send("ready")},u.emit=function(e){if(p){if(e instanceof t)return void u.send({id:p,isEvent:!0,payload:e.message},e.transfer);u.send({id:p,isEvent:!0,payload:e})}},n.add=u.register,n.emit=u.emit}(t),n(t)}));
//# sourceMappingURL=worker.min.js.map
`});var We=W((Lr,C)=>{"use strict";var{Promise:V}=J(),Le=Z(),{validateOptions:ie,forkOptsNames:xe,workerThreadOptsNames:er,workerOptsNames:rr}=be(),ye="__workerpool-terminate__",De="__workerpool-cleanup__";function Ae(){var e=se();if(!e)throw new Error("WorkerPool: workerType = 'thread' is not supported, Node >= 11.7.0 required");return e}function Ee(){if(typeof Worker!="function"&&(typeof Worker!="object"||typeof Worker.prototype.constructor!="function"))throw new Error("WorkerPool: Web Workers not supported")}function se(){try{return require("worker_threads")}catch(e){if(typeof e=="object"&&e!==null&&e.code==="MODULE_NOT_FOUND")return null;throw e}}function nr(){if(Le.platform==="browser"){if(typeof Blob>"u")throw new Error("Blob not supported by the browser");if(!window.URL||typeof window.URL.createObjectURL!="function")throw new Error("URL.createObjectURL not supported by the browser");var e=new Blob([_e()],{type:"text/javascript"});return window.URL.createObjectURL(e)}else return __dirname+"/worker.js"}function tr(e,r){if(r.workerType==="web")return Ee(),re(e,r.workerOpts,Worker);if(r.workerType==="thread")return n=Ae(),ne(e,n,r);if(r.workerType==="process"||!r.workerType)return te(e,Oe(r),require("child_process"));if(Le.platform==="browser")return Ee(),re(e,r.workerOpts,Worker);var n=se();return n?ne(e,n,r):te(e,Oe(r),require("child_process"))}function re(e,r,n){ie(r,rr,"workerOpts");var t=new n(e,r);return t.isBrowserWorker=!0,t.on=function(i,s){this.addEventListener(i,function(o){s(o.data)})},t.send=function(i,s){this.postMessage(i,s)},t}function ne(e,r,n){ie(n?.workerThreadOpts,er,"workerThreadOpts");var t=new r.Worker(e,{stdout:n?.emitStdStreams??!1,stderr:n?.emitStdStreams??!1,...n?.workerThreadOpts});return t.isWorkerThread=!0,t.send=function(i,s){this.postMessage(i,s)},t.kill=function(){return this.terminate(),!0},t.disconnect=function(){this.terminate()},n?.emitStdStreams&&(t.stdout.on("data",i=>t.emit("stdout",i)),t.stderr.on("data",i=>t.emit("stderr",i))),t}function te(e,r,n){ie(r.forkOpts,xe,"forkOpts");var t=n.fork(e,r.forkArgs,r.forkOpts),i=t.send;return t.send=function(s){return i.call(t,s)},r.emitStdStreams&&(t.stdout.on("data",s=>t.emit("stdout",s)),t.stderr.on("data",s=>t.emit("stderr",s))),t.isChildProcess=!0,t}function Oe(e){e=e||{};var r=process.execArgv.join(" "),n=r.indexOf("--inspect")!==-1,t=r.indexOf("--debug-brk")!==-1,i=[];return n&&(i.push("--inspect="+e.debugPort),t&&i.push("--debug-brk")),process.execArgv.forEach(function(s){s.indexOf("--max-old-space-size")>-1&&i.push(s)}),Object.assign({},e,{forkArgs:e.forkArgs,forkOpts:Object.assign({},e.forkOpts,{execArgv:(e.forkOpts&&e.forkOpts.execArgv||[]).concat(i),stdio:e.emitStdStreams?"pipe":void 0})})}function Te(e){for(var r=new Error(""),n=Object.keys(e),t=0;t<n.length;t++)r[n[t]]=e[n[t]];return r}function Me(e,r){Object.values(e.processing).forEach(n=>n?.options?.on(r)),Object.values(e.tracking).forEach(n=>n?.options?.on(r))}function H(e,r){var n=this,t=r||{};this.script=e||nr(),this.worker=tr(this.script,t),this.debugPort=t.debugPort,this.forkOpts=t.forkOpts,this.forkArgs=t.forkArgs,this.workerOpts=t.workerOpts,this.workerThreadOpts=t.workerThreadOpts,this.workerTerminateTimeout=t.workerTerminateTimeout,e||(this.worker.ready=!0),this.requestQueue=[],this.worker.on("stdout",function(a){Me(n,{stdout:a.toString()})}),this.worker.on("stderr",function(a){Me(n,{stderr:a.toString()})}),this.worker.on("message",function(a){if(!n.terminated)if(typeof a=="string"&&a==="ready")n.worker.ready=!0,s();else{var u=a.id,f=n.processing[u];if(f!==void 0)a.isEvent?f.options&&typeof f.options.on=="function"&&f.options.on(a.payload):(delete n.processing[u],n.terminating===!0&&n.terminate(),a.error?f.resolver.reject(Te(a.error)):f.resolver.resolve(a.result));else{var f=n.tracking[u];f!==void 0&&a.isEvent&&f.options&&typeof f.options.on=="function"&&f.options.on(a.payload)}if(a.method===De){var l=n.tracking[a.id];l!==void 0&&(a.error?(clearTimeout(l.timeoutId),l.resolver.reject(Te(a.error))):(n.tracking&&clearTimeout(l.timeoutId),l.resolver.reject(new Se(l.error)))),delete n.tracking[u]}}});function i(a){n.terminated=!0;for(var u in n.processing)n.processing[u]!==void 0&&n.processing[u].resolver.reject(a);n.processing=Object.create(null)}function s(){for(let a of n.requestQueue.splice(0))n.worker.send(a.message,a.transfer)}var o=this.worker;this.worker.on("error",i),this.worker.on("exit",function(a,u){var f=`Workerpool Worker terminated Unexpectedly
`;f+="    exitCode: `"+a+"`\n",f+="    signalCode: `"+u+"`\n",f+="    workerpool.script: `"+n.script+"`\n",f+="    spawnArgs: `"+o.spawnargs+"`\n",f+="    spawnfile: `"+o.spawnfile+"`\n",f+="    stdout: `"+o.stdout+"`\n",f+="    stderr: `"+o.stderr+"`\n",i(new Error(f))}),this.processing=Object.create(null),this.tracking=Object.create(null),this.terminating=!1,this.terminated=!1,this.cleaning=!1,this.terminationHandler=null,this.lastId=0}H.prototype.methods=function(){return this.exec("methods")};H.prototype.exec=function(e,r,n,t){n||(n=V.defer());var i=++this.lastId;this.processing[i]={id:i,resolver:n,options:t};var s={message:{id:i,method:e,params:r},transfer:t&&t.transfer};this.terminated?n.reject(new Error("Worker is terminated")):this.worker.ready?this.worker.send(s.message,s.transfer):this.requestQueue.push(s);var o=this;return n.promise.catch(function(a){if(a instanceof V.CancellationError||a instanceof V.TimeoutError)return o.tracking[i]={id:i,resolver:V.defer(),options:t,error:a},delete o.processing[i],o.tracking[i].resolver.promise=o.tracking[i].resolver.promise.catch(function(u){if(delete o.tracking[i],u instanceof Se)throw u.error;var f=o.terminateAndNotify(!0).then(function(){throw u},function(l){throw l});return f}),o.worker.send({id:i,method:De}),o.tracking[i].timeoutId=setTimeout(function(){o.tracking[i].resolver.reject(a)},o.workerTerminateTimeout),o.tracking[i].resolver.promise;throw a})};H.prototype.busy=function(){return this.cleaning||Object.keys(this.processing).length>0};H.prototype.terminate=function(e,r){var n=this;if(e){for(var t in this.processing)this.processing[t]!==void 0&&this.processing[t].resolver.reject(new Error("Worker terminated"));this.processing=Object.create(null)}for(var i of Object.values(n.tracking))clearTimeout(i.timeoutId),i.resolver.reject(new Error("Worker Terminating"));if(n.tracking=Object.create(null),typeof r=="function"&&(this.terminationHandler=r),this.busy())this.terminating=!0;else{var s=function(a){if(n.terminated=!0,n.cleaning=!1,n.worker!=null&&n.worker.removeAllListeners&&n.worker.removeAllListeners("message"),n.worker=null,n.terminating=!1,n.terminationHandler)n.terminationHandler(a,n);else if(a)throw a};if(this.worker)if(typeof this.worker.kill=="function"){if(this.worker.killed){s(new Error("worker already killed!"));return}var o=setTimeout(function(){n.worker&&n.worker.kill()},this.workerTerminateTimeout);this.worker.once("exit",function(){clearTimeout(o),n.worker&&(n.worker.killed=!0),s()}),this.worker.ready?this.worker.send(ye):this.requestQueue.push({message:ye}),this.cleaning=!0;return}else if(typeof this.worker.terminate=="function")this.worker.terminate(),this.worker.killed=!0;else throw new Error("Failed to terminate worker");s()}};H.prototype.terminateAndNotify=function(e,r){var n=V.defer();return r&&n.promise.timeout(r),this.terminate(e,function(t,i){t?n.reject(t):n.resolve(i)}),n.promise};function Se(e){this.error=e,this.stack=new Error().stack}C.exports=H;C.exports._tryRequireWorkerThreads=se;C.exports._setupProcessWorker=te;C.exports._setupBrowserWorker=re;C.exports._setupWorkerThreadWorker=ne;C.exports.ensureWorkerThreads=Ae});var Re=W((Dr,je)=>{"use strict";var Pe=65535;je.exports=oe;function oe(){this.ports=Object.create(null),this.length=0}oe.prototype.nextAvailableStartingAt=function(e){for(;this.ports[e]===!0;)e++;if(e>=Pe)throw new Error("WorkerPool debug port limit reached: "+e+">= "+Pe);return this.ports[e]=!0,this.length++,e};oe.prototype.releasePort=function(e){delete this.ports[e],this.length--}});var Ue=W((Ar,Fe)=>{var{Promise:ae}=J(),Ie=We(),ir=Z(),sr=Re(),ue=new sr;function P(e,r){typeof e=="string"?this.script=e||null:(this.script=null,r=e),this.workers=[],this.tasks=[],r=r||{},this.forkArgs=Object.freeze(r.forkArgs||[]),this.forkOpts=Object.freeze(r.forkOpts||{}),this.workerOpts=Object.freeze(r.workerOpts||{}),this.workerThreadOpts=Object.freeze(r.workerThreadOpts||{}),this.debugPortStart=r.debugPortStart||43210,this.nodeWorker=r.nodeWorker,this.workerType=r.workerType||r.nodeWorker||"auto",this.maxQueueSize=r.maxQueueSize||1/0,this.workerTerminateTimeout=r.workerTerminateTimeout||1e3,this.onCreateWorker=r.onCreateWorker||(()=>null),this.onTerminateWorker=r.onTerminateWorker||(()=>null),this.emitStdStreams=r.emitStdStreams||!1,r&&"maxWorkers"in r?(or(r.maxWorkers),this.maxWorkers=r.maxWorkers):this.maxWorkers=Math.max((ir.cpus||4)-1,1),r&&"minWorkers"in r&&(r.minWorkers==="max"?this.minWorkers=this.maxWorkers:(ar(r.minWorkers),this.minWorkers=r.minWorkers,this.maxWorkers=Math.max(this.minWorkers,this.maxWorkers)),this._ensureMinWorkers()),this._boundNext=this._next.bind(this),this.workerType==="thread"&&Ie.ensureWorkerThreads()}P.prototype.exec=function(e,r,n){if(r&&!Array.isArray(r))throw new TypeError('Array expected as argument "params"');if(typeof e=="string"){var t=ae.defer();if(this.tasks.length>=this.maxQueueSize)throw new Error("Max queue size of "+this.maxQueueSize+" reached");var i=this.tasks,s={method:e,params:r,resolver:t,timeout:null,options:n};i.push(s);var o=t.promise.timeout;return t.promise.timeout=function(u){return i.indexOf(s)!==-1?(s.timeout=u,t.promise):o.call(t.promise,u)},this._next(),t.promise}else{if(typeof e=="function")return this.exec("run",[String(e),r],n);throw new TypeError('Function or string expected as argument "method"')}};P.prototype.proxy=function(){if(arguments.length>0)throw new Error("No arguments expected");var e=this;return this.exec("methods").then(function(r){var n={};return r.forEach(function(t){n[t]=function(){return e.exec(t,Array.prototype.slice.call(arguments))}}),n})};P.prototype._next=function(){if(this.tasks.length>0){var e=this._getWorker();if(e){var r=this,n=this.tasks.shift();if(n.resolver.promise.pending){var t=e.exec(n.method,n.params,n.resolver,n.options).then(r._boundNext).catch(function(){if(e.terminated)return r._removeWorker(e)}).then(function(){r._next()});typeof n.timeout=="number"&&t.timeout(n.timeout)}else r._next()}}};P.prototype._getWorker=function(){for(var e=this.workers,r=0;r<e.length;r++){var n=e[r];if(n.busy()===!1)return n}return e.length<this.maxWorkers?(n=this._createWorkerHandler(),e.push(n),n):null};P.prototype._removeWorker=function(e){var r=this;return ue.releasePort(e.debugPort),this._removeWorkerFromList(e),this._ensureMinWorkers(),new ae(function(n,t){e.terminate(!1,function(i){r.onTerminateWorker({forkArgs:e.forkArgs,forkOpts:e.forkOpts,workerThreadOpts:e.workerThreadOpts,script:e.script}),i?t(i):n(e)})})};P.prototype._removeWorkerFromList=function(e){var r=this.workers.indexOf(e);r!==-1&&this.workers.splice(r,1)};P.prototype.terminate=function(e,r){var n=this;this.tasks.forEach(function(a){a.resolver.reject(new Error("Pool terminated"))}),this.tasks.length=0;var t=function(a){ue.releasePort(a.debugPort),this._removeWorkerFromList(a)},i=t.bind(this),s=[],o=this.workers.slice();return o.forEach(function(a){var u=a.terminateAndNotify(e,r).then(i).always(function(){n.onTerminateWorker({forkArgs:a.forkArgs,forkOpts:a.forkOpts,workerThreadOpts:a.workerThreadOpts,script:a.script})});s.push(u)}),ae.all(s)};P.prototype.stats=function(){var e=this.workers.length,r=this.workers.filter(function(n){return n.busy()}).length;return{totalWorkers:e,busyWorkers:r,idleWorkers:e-r,pendingTasks:this.tasks.length,activeTasks:r}};P.prototype._ensureMinWorkers=function(){if(this.minWorkers)for(var e=this.workers.length;e<this.minWorkers;e++)this.workers.push(this._createWorkerHandler())};P.prototype._createWorkerHandler=function(){let e=this.onCreateWorker({forkArgs:this.forkArgs,forkOpts:this.forkOpts,workerOpts:this.workerOpts,workerThreadOpts:this.workerThreadOpts,script:this.script})||{};return new Ie(e.script||this.script,{forkArgs:e.forkArgs||this.forkArgs,forkOpts:e.forkOpts||this.forkOpts,workerOpts:e.workerOpts||this.workerOpts,workerThreadOpts:e.workerThreadOpts||this.workerThreadOpts,debugPort:ue.nextAvailableStartingAt(this.debugPortStart),workerType:this.workerType,workerTerminateTimeout:this.workerTerminateTimeout,emitStdStreams:this.emitStdStreams})};function or(e){if(!Ne(e)||!Ce(e)||e<1)throw new TypeError("Option maxWorkers must be an integer number >= 1")}function ar(e){if(!Ne(e)||!Ce(e)||e<0)throw new TypeError("Option minWorkers must be an integer number >= 0")}function Ne(e){return typeof e=="number"}function Ce(e){return Math.round(e)==e}Fe.exports=P});var fe=W((Sr,Be)=>{function ur(e,r){this.message=e,this.transfer=r}Be.exports=ur});var le=W(Y=>{var he=fe(),G=J().Promise,fr="__workerpool-terminate__",K="__workerpool-cleanup__",He=1e3,d={exit:function(){}},ze={addAbortListener:function(e){d.abortListeners.push(e)},emit:d.emit};if(typeof self<"u"&&typeof postMessage=="function"&&typeof addEventListener=="function")d.on=function(e,r){addEventListener(e,function(n){r(n.data)})},d.send=function(e,r){r?postMessage(e,r):postMessage(e)};else if(typeof process<"u"){try{X=require("worker_threads")}catch(e){if(!(typeof e=="object"&&e!==null&&e.code==="MODULE_NOT_FOUND"))throw e}X&&X.parentPort!==null?($=X.parentPort,d.send=$.postMessage.bind($),d.on=$.on.bind($),d.exit=process.exit.bind(process)):(d.on=process.on.bind(process),d.send=function(e){process.send(e)},d.on("disconnect",function(){process.exit(1)}),d.exit=process.exit.bind(process))}else throw new Error("Script must be executed as a worker");var X,$;function x(e){return e&&e.toJSON?JSON.parse(JSON.stringify(e)):JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)))}function Qe(e){return e&&typeof e.then=="function"&&typeof e.catch=="function"}d.methods={};d.methods.run=function(r,n){var t=new Function("return ("+r+").apply(this, arguments);");return t.worker=ze,t.apply(t,n)};d.methods.methods=function(){return Object.keys(d.methods)};d.terminationHandler=void 0;d.abortListenerTimeout=He;d.abortListeners=[];d.terminateAndExit=function(e){var r=function(){d.exit(e)};if(!d.terminationHandler)return r();var n=d.terminationHandler(e);return Qe(n)?(n.then(r,r),n):(r(),new G(function(t,i){i(new Error("Worker terminating"))}))};d.cleanup=function(e){if(!d.abortListeners.length)return d.send({id:e,method:K,error:x(new Error("Worker terminating"))}),new G(function(a){a()});var r=function(){d.exit()},n=function(){d.abortListeners.length||(d.abortListeners=[])};let t=d.abortListeners.map(a=>a()),i,s=new G((a,u)=>{i=setTimeout(function(){u(new Error("Timeout occured waiting for abort handler, killing worker"))},d.abortListenerTimeout)}),o=G.all(t).then(function(){clearTimeout(i),n()},function(){clearTimeout(i),r()});return new G(function(a,u){o.then(a,u),s.then(a,u)}).then(function(){d.send({id:e,method:K,error:null})},function(a){d.send({id:e,method:K,error:a?x(a):null})})};var F=null;d.on("message",function(e){if(e===fr)return d.terminateAndExit(0);if(e.method===K)return d.cleanup(e.id);try{var r=d.methods[e.method];if(r){F=e.id;var n=r.apply(r,e.params);Qe(n)?n.then(function(t){t instanceof he?d.send({id:e.id,result:t.message,error:null},t.transfer):d.send({id:e.id,result:t,error:null}),F=null}).catch(function(t){d.send({id:e.id,result:null,error:x(t)}),F=null}):(n instanceof he?d.send({id:e.id,result:n.message,error:null},n.transfer):d.send({id:e.id,result:n,error:null}),F=null)}else throw new Error('Unknown method "'+e.method+'"')}catch(t){d.send({id:e.id,result:null,error:x(t)})}});d.register=function(e,r){if(e)for(var n in e)e.hasOwnProperty(n)&&(d.methods[n]=e[n],d.methods[n].worker=ze);r&&(d.terminationHandler=r.onTerminate,d.abortListenerTimeout=r.abortListenerTimeout||He),d.send("ready")};d.emit=function(e){if(F){if(e instanceof he){d.send({id:F,isEvent:!0,payload:e.message},e.transfer);return}d.send({id:F,isEvent:!0,payload:e})}};typeof Y<"u"&&(Y.add=d.register,Y.emit=d.emit)});var Je=W(R=>{var{platform:hr,isMainThread:lr,cpus:cr}=Z();function gr(e,r){var n=Ue();return new n(e,r)}R.pool=gr;function mr(e,r){var n=le();n.add(e,r)}R.worker=mr;function dr(e){var r=le();r.emit(e)}R.workerEmit=dr;var{Promise:pr}=J();R.Promise=pr;R.Transfer=fe();R.platform=hr;R.isMainThread=lr;R.cpus=cr});var br={};module.exports=Ye(br);var I=ge(me());var B=class e{startLine;count;constructor(r,n){this.startLine=r,this.count=n}get endLine(){return this.startLine+this.count-1}get startLineOneBased(){return this.startLine+1}get endLineOneBased(){return this.endLine+1}get rangeOutput(){return{startLine:this.startLineOneBased,count:this.count}}equals(r){return this.startLine===r.startLine&&this.count===r.count}doesIntersect(r){return this.startLine<=r.endLine&&r.startLine<=this.endLine}union(r){return e.fromEndLine(Math.min(this.startLine,r.startLine),Math.max(this.endLine,r.endLine))}static fromCount(r,n){return new e(r,n)}static fromEndLine(r,n){return new e(r,n-r+1)}static fromRangeOutput(r){return new e(r.startLine-1,r.count)}static fromOneBased(r,n){return e.fromEndLine(r-1,n-1)}static fromOneBasedCount(r,n){return e.fromCount(r-1,n)}};var qe=ge(Je());function Ve(e,r,n=!1){let t=new I.default,i=t.diff_main(e,r);t.diff_cleanupSemanticLossless(i);let s=0,o=[],a=[];for(let u of i){let[f,l]=u,c=l.split(`
`),m=c.length-1,g=c.length;c[c.length-1]===""&&(g=g-1);let v=n||l.trim()!=="";f===I.default.DIFF_INSERT&&v?o.push(B.fromCount(s,g)):f===I.default.DIFF_DELETE&&v&&a.push(B.fromCount(s,g)),(f===I.default.DIFF_EQUAL||f===I.default.DIFF_INSERT)&&(s+=m)}return{added:o,removed:a}}function vr(e,r){let n=new I.default,{chars1:t,chars2:i,lineArray:s}=n.diff_linesToChars_(e,r),o=n.diff_main(t,i,!1);n.diff_charsToLines_(o,s);let a=0,u=0;for(let f of o){let[l,c]=f,m=c.split(`
`),g=m.length;m[m.length-1]===""&&(g-=1),l===I.default.DIFF_INSERT?a+=g:l===I.default.DIFF_DELETE&&(u+=g)}return{addedLines:a,removedLines:u}}function wr(e,r){let n=[],t=Ve(e,r,!1);n.push(...t.added);for(let i of t.removed){let s=B.fromEndLine(Math.max(i.startLine-1,0),Math.min(i.startLine+1,r.split(`
`).length-1));n.push(s)}return n.map(i=>i.rangeOutput)}qe.worker({getChanges:Ve,getDiffStats:vr,getImpactedRanges:wr});
